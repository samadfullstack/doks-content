1.  [Cookbook](https://docs.flutter.dev/cookbook)
2.  [Games](https://docs.flutter.dev/cookbook/games)
3.  [Add multiplayer support using Firestore](https://docs.flutter.dev/cookbook/games/firestore-multiplayer)

Multiplayer games need a way to synchronize game states between players. Broadly speaking, two types of multiplayer games exist:

1.  **High tick rate**. These games need to synchronize game states many times per second with low latency. These would include action games, sports games, fighting games.
    
2.  **Low tick rate**. These games only need to synchronize game states occasionally with latency having less impact. These would include card games, strategy games, puzzle games.
    

This resembles the differentiation between real-time versus turn-based games, though the analogy falls short. For example, real-time strategy games run—as the name suggests—in real-time, but that doesn’t correlate to a high tick rate. These games can simulate much of what happens in between player interactions on local machines. Therefore, they don’t need to synchronize game states that often.

![An illustration of two mobile phones and a two-way arrow between them](https://docs.flutter.dev/assets/images/docs/cookbook/multiplayer-two-mobiles.jpg)

If you can choose low tick rates as a developer, you should. Low tick lowers latency requirements and server costs. Sometimes, a game requires high tick rates of synchronization. For those cases, solutions such as Firestore _don’t make a good fit_. Pick a dedicated multiplayer server solution such as [Nakama](https://heroiclabs.com/nakama/). Nakama has a [Dart package](https://pub.dev/packages/nakama).

If you expect that your game requires a low tick rate of synchronization, continue reading.

This recipe demonstrates how to use the [`cloud_firestore` package](https://pub.dev/packages/cloud_firestore) to implement multiplayer capabilities in your game. This recipe doesn’t require a server. It uses two or more clients sharing game state using Cloud Firestore.

## 1\. Prepare your game for multiplayer

Write your game code to allow changing the game state in response to both local events and remote events. A local event could be a player action or some game logic. A remote event could be a world update coming from the server.

![Screenshot of the card game](https://docs.flutter.dev/assets/images/docs/cookbook/multiplayer-card-game.jpg)

To simplify this cookbook recipe, start with the [`card`](https://github.com/flutter/games/tree/main/templates/card#readme) template that you’ll find in the [`flutter/games` repository](https://github.com/flutter/games). Run the following command to clone that repository:

```
<span>git clone https://github.com/flutter/games.git
</span>
```

Open the project in `templates/card`.

## 2\. Install Firestore

[Cloud Firestore](https://cloud.google.com/firestore/) is a horizontally scaling, NoSQL document database in the cloud. It includes built-in live synchronization. This is perfect for our needs. It keeps the game state updated in the cloud database, so every player sees the same state.

If you want a quick, 15-minute primer on Cloud Firestore, check out the following video:

<iframe width="560" height="315" src="https://www.youtube.com/embed/v_hR4K4auoQ?enablejsapi=1&amp;origin=https%3A%2F%2Fdocs.flutter.dev" title="What is a NoSQL Database? Learn about Cloud Firestore" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" loading="lazy" data-gtm-yt-inspected-9257802_51="true" id="522964874" data-gtm-yt-inspected-9257802_75="true" data-gtm-yt-inspected-9257802_114="true" data-gtm-yt-inspected-6="true"></iframe>

To add Firestore to your Flutter project, follow the first two steps of the [Get started with Cloud Firestore](https://firebase.google.com/docs/firestore/quickstart) guide:

-   [Create a Cloud Firestore database](https://firebase.google.com/docs/firestore/quickstart#create)
-   [Set up your development environment](https://firebase.google.com/docs/firestore/quickstart#set_up_your_development_environment)

The desired outcomes include:

-   A Firestore database ready in the cloud, in **Test mode**
-   A generated `firebase_options.dart` file
-   The appropriate plugins added to your `pubspec.yaml`

You _don’t_ need to write any Dart code in this step. As soon as you understand the step of writing Dart code in that guide, return to this recipe.

## 3\. Initialize Firestore

1.  Open `lib/main.dart` and import the plugins, as well as the `firebase_options.dart` file that was generated by `flutterfire configure` in the previous step.
    
    ```
    <span>import</span><span> </span><span>'package:cloud_firestore/cloud_firestore.dart'</span><span>;</span><span>
     </span><span>import</span><span> </span><span>'package:firebase_core/firebase_core.dart'</span><span>;</span><span>
    
     </span><span>import</span><span> </span><span>'firebase_options.dart'</span><span>;</span>
    ```
    
2.  Add the following code just above the call to `runApp()` in `lib/main.dart`:
    
    ```
    <span>WidgetsFlutterBinding</span><span>.</span><span>ensureInitialized</span><span>();</span><span>
    
     </span><span>await</span><span> </span><span>Firebase</span><span>.</span><span>initializeApp</span><span>(</span><span>
       options</span><span>:</span><span> </span><span>DefaultFirebaseOptions</span><span>.</span><span>currentPlatform</span><span>,</span><span>
     </span><span>);</span>
    ```
    
    This ensures that Firebase is initialized on game startup.
    
3.  Add the Firestore instance to the app. That way, any widget can access this instance. Widgets can also react to the instance missing, if needed.
    
    To do this with the `card` template, you can use the `provider` package (which is already installed as a dependency).
    
    Replace the boilerplate `runApp(MyApp())` with the following:
    
    ```
    <span>runApp</span><span>(</span><span>
       </span><span>Provider</span><span>.</span><span>value</span><span>(</span><span>
         value</span><span>:</span><span> </span><span>FirebaseFirestore</span><span>.</span><span>instance</span><span>,</span><span>
         child</span><span>:</span><span> </span><span>MyApp</span><span>(),</span><span>
       </span><span>),</span><span>
     </span><span>);</span>
    ```
    
    Put the provider above `MyApp`, not inside it. This enables you to test the app without Firebase.
    

## 4\. Create a Firestore controller class

Though you can talk to Firestore directly, you should write a dedicated controller class to make the code more readable and maintainable.

How you implement the controller depends on your game and on the exact design of your multiplayer experience. For the case of the `card` template, you could synchronize the contents of the two circular playing areas. It’s not enough for a full multiplayer experience, but it’s a good start.

![Screenshot of the card game, with arrows pointing to playing areas](https://docs.flutter.dev/assets/images/docs/cookbook/multiplayer-areas.jpg)

To create a controller, copy, then paste the following code into a new file called `lib/multiplayer/firestore_controller.dart`.

```
<span>import</span><span> </span><span>'dart:async'</span><span>;</span><span>

</span><span>import</span><span> </span><span>'package:cloud_firestore/cloud_firestore.dart'</span><span>;</span><span>
</span><span>import</span><span> </span><span>'package:flutter/foundation.dart'</span><span>;</span><span>
</span><span>import</span><span> </span><span>'package:logging/logging.dart'</span><span>;</span><span>

</span><span>import</span><span> </span><span>'../game_internals/board_state.dart'</span><span>;</span><span>
</span><span>import</span><span> </span><span>'../game_internals/playing_area.dart'</span><span>;</span><span>
</span><span>import</span><span> </span><span>'../game_internals/playing_card.dart'</span><span>;</span><span>

</span><span>class</span><span> </span><span>FirestoreController</span><span> </span><span>{</span><span>
  </span><span>static</span><span> </span><span>final</span><span> _log </span><span>=</span><span> </span><span>Logger</span><span>(</span><span>'FirestoreController'</span><span>);</span><span>

  </span><span>final</span><span> </span><span>FirebaseFirestore</span><span> instance</span><span>;</span><span>

  </span><span>final</span><span> </span><span>BoardState</span><span> boardState</span><span>;</span><span>

  </span><span>/// For now, there is only one match. But in order to be ready</span><span>
  </span><span>/// for match-making, put it in a Firestore collection called matches.</span><span>
  </span><span>late</span><span> </span><span>final</span><span> _matchRef </span><span>=</span><span> instance</span><span>.</span><span>collection</span><span>(</span><span>'matches'</span><span>).</span><span>doc</span><span>(</span><span>'match_1'</span><span>);</span><span>

  </span><span>late</span><span> </span><span>final</span><span> _areaOneRef </span><span>=</span><span> _matchRef
      </span><span>.</span><span>collection</span><span>(</span><span>'areas'</span><span>)</span><span>
      </span><span>.</span><span>doc</span><span>(</span><span>'area_one'</span><span>)</span><span>
      </span><span>.</span><span>withConverter</span><span>&lt;</span><span>List</span><span>&lt;</span><span>PlayingCard</span><span>&gt;&gt;(</span><span>
      fromFirestore</span><span>:</span><span> _cardsFromFirestore</span><span>,</span><span> toFirestore</span><span>:</span><span> _cardsToFirestore</span><span>);</span><span>

  </span><span>late</span><span> </span><span>final</span><span> _areaTwoRef </span><span>=</span><span> _matchRef
      </span><span>.</span><span>collection</span><span>(</span><span>'areas'</span><span>)</span><span>
      </span><span>.</span><span>doc</span><span>(</span><span>'area_two'</span><span>)</span><span>
      </span><span>.</span><span>withConverter</span><span>&lt;</span><span>List</span><span>&lt;</span><span>PlayingCard</span><span>&gt;&gt;(</span><span>
      fromFirestore</span><span>:</span><span> _cardsFromFirestore</span><span>,</span><span> toFirestore</span><span>:</span><span> _cardsToFirestore</span><span>);</span><span>

  </span><span>StreamSubscription</span><span>?</span><span> _areaOneFirestoreSubscription</span><span>;</span><span>
  </span><span>StreamSubscription</span><span>?</span><span> _areaTwoFirestoreSubscription</span><span>;</span><span>

  </span><span>StreamSubscription</span><span>?</span><span> _areaOneLocalSubscription</span><span>;</span><span>
  </span><span>StreamSubscription</span><span>?</span><span> _areaTwoLocalSubscription</span><span>;</span><span>

  </span><span>FirestoreController</span><span>({</span><span>required</span><span> </span><span>this</span><span>.</span><span>instance</span><span>,</span><span> </span><span>required</span><span> </span><span>this</span><span>.</span><span>boardState</span><span>})</span><span> </span><span>{</span><span>
    </span><span>// Subscribe to the remote changes (from Firestore).</span><span>
    _areaOneFirestoreSubscription </span><span>=</span><span> _areaOneRef</span><span>.</span><span>snapshots</span><span>().</span><span>listen</span><span>((</span><span>snapshot</span><span>)</span><span> </span><span>{</span><span>
      _updateLocalFromFirestore</span><span>(</span><span>boardState</span><span>.</span><span>areaOne</span><span>,</span><span> snapshot</span><span>);</span><span>
    </span><span>});</span><span>
    _areaTwoFirestoreSubscription </span><span>=</span><span> _areaTwoRef</span><span>.</span><span>snapshots</span><span>().</span><span>listen</span><span>((</span><span>snapshot</span><span>)</span><span> </span><span>{</span><span>
      _updateLocalFromFirestore</span><span>(</span><span>boardState</span><span>.</span><span>areaTwo</span><span>,</span><span> snapshot</span><span>);</span><span>
    </span><span>});</span><span>

    </span><span>// Subscribe to the local changes in game state.</span><span>
    _areaOneLocalSubscription </span><span>=</span><span> boardState</span><span>.</span><span>areaOne</span><span>.</span><span>playerChanges</span><span>.</span><span>listen</span><span>((</span><span>_</span><span>)</span><span> </span><span>{</span><span>
      _updateFirestoreFromLocalAreaOne</span><span>();</span><span>
    </span><span>});</span><span>
    _areaTwoLocalSubscription </span><span>=</span><span> boardState</span><span>.</span><span>areaTwo</span><span>.</span><span>playerChanges</span><span>.</span><span>listen</span><span>((</span><span>_</span><span>)</span><span> </span><span>{</span><span>
      _updateFirestoreFromLocalAreaTwo</span><span>();</span><span>
    </span><span>});</span><span>

    _log</span><span>.</span><span>fine</span><span>(</span><span>'Initialized'</span><span>);</span><span>
  </span><span>}</span><span>

  </span><span>void</span><span> dispose</span><span>()</span><span> </span><span>{</span><span>
    _areaOneFirestoreSubscription</span><span>?.</span><span>cancel</span><span>();</span><span>
    _areaTwoFirestoreSubscription</span><span>?.</span><span>cancel</span><span>();</span><span>
    _areaOneLocalSubscription</span><span>?.</span><span>cancel</span><span>();</span><span>
    _areaTwoLocalSubscription</span><span>?.</span><span>cancel</span><span>();</span><span>

    _log</span><span>.</span><span>fine</span><span>(</span><span>'Disposed'</span><span>);</span><span>
  </span><span>}</span><span>

  </span><span>/// Takes the raw JSON snapshot coming from Firestore and attempts to</span><span>
  </span><span>/// convert it into a list of [PlayingCard]s.</span><span>
  </span><span>List</span><span>&lt;</span><span>PlayingCard</span><span>&gt;</span><span> _cardsFromFirestore</span><span>(</span><span>
      </span><span>DocumentSnapshot</span><span>&lt;</span><span>Map</span><span>&lt;</span><span>String</span><span>,</span><span> </span><span>dynamic</span><span>&gt;&gt;</span><span> snapshot</span><span>,</span><span>
      </span><span>SnapshotOptions</span><span>?</span><span> options</span><span>,</span><span>
      </span><span>)</span><span> </span><span>{</span><span>
    </span><span>final</span><span> data </span><span>=</span><span> snapshot</span><span>.</span><span>data</span><span>()?[</span><span>'cards'</span><span>]</span><span> </span><span>as</span><span> </span><span>List</span><span>?;</span><span>

    </span><span>if</span><span> </span><span>(</span><span>data </span><span>==</span><span> </span><span>null</span><span>)</span><span> </span><span>{</span><span>
      _log</span><span>.</span><span>info</span><span>(</span><span>'No data found on Firestore, returning empty list'</span><span>);</span><span>
      </span><span>return</span><span> </span><span>[];</span><span>
    </span><span>}</span><span>

    </span><span>final</span><span> list </span><span>=</span><span> </span><span>List</span><span>.</span><span>castFrom</span><span>&lt;</span><span>Object</span><span>?,</span><span> </span><span>Map</span><span>&lt;</span><span>String</span><span>,</span><span> </span><span>Object</span><span>?&gt;&gt;(</span><span>data</span><span>);</span><span>

    </span><span>try</span><span> </span><span>{</span><span>
      </span><span>return</span><span> list</span><span>.</span><span>map</span><span>((</span><span>raw</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>PlayingCard</span><span>.</span><span>fromJson</span><span>(</span><span>raw</span><span>)).</span><span>toList</span><span>();</span><span>
    </span><span>}</span><span> </span><span>catch</span><span> </span><span>(</span><span>e</span><span>)</span><span> </span><span>{</span><span>
      </span><span>throw</span><span> </span><span>FirebaseControllerException</span><span>(</span><span>
          </span><span>'Failed to parse data from Firestore: $e'</span><span>);</span><span>
    </span><span>}</span><span>
  </span><span>}</span><span>

  </span><span>/// Takes a list of [PlayingCard]s and converts it into a JSON object</span><span>
  </span><span>/// that can be saved into Firestore.</span><span>
  </span><span>Map</span><span>&lt;</span><span>String</span><span>,</span><span> </span><span>Object</span><span>?&gt;</span><span> _cardsToFirestore</span><span>(</span><span>
      </span><span>List</span><span>&lt;</span><span>PlayingCard</span><span>&gt;</span><span> cards</span><span>,</span><span>
      </span><span>SetOptions</span><span>?</span><span> options</span><span>,</span><span>
      </span><span>)</span><span> </span><span>{</span><span>
    </span><span>return</span><span> </span><span>{</span><span>'cards'</span><span>:</span><span> cards</span><span>.</span><span>map</span><span>((</span><span>c</span><span>)</span><span> </span><span>=&gt;</span><span> c</span><span>.</span><span>toJson</span><span>()).</span><span>toList</span><span>()};</span><span>
  </span><span>}</span><span>

  </span><span>/// Updates Firestore with the local state of [area].</span><span>
  </span><span>Future</span><span>&lt;</span><span>void</span><span>&gt;</span><span> _updateFirestoreFromLocal</span><span>(</span><span>
      </span><span>PlayingArea</span><span> area</span><span>,</span><span> </span><span>DocumentReference</span><span>&lt;</span><span>List</span><span>&lt;</span><span>PlayingCard</span><span>&gt;&gt;</span><span> ref</span><span>)</span><span> </span><span>async</span><span> </span><span>{</span><span>
    </span><span>try</span><span> </span><span>{</span><span>
      _log</span><span>.</span><span>fine</span><span>(</span><span>'Updating Firestore with local data (${area.cards}) ...'</span><span>);</span><span>
      </span><span>await</span><span> ref</span><span>.</span><span>set</span><span>(</span><span>area</span><span>.</span><span>cards</span><span>);</span><span>
      _log</span><span>.</span><span>fine</span><span>(</span><span>'... done updating.'</span><span>);</span><span>
    </span><span>}</span><span> </span><span>catch</span><span> </span><span>(</span><span>e</span><span>)</span><span> </span><span>{</span><span>
      </span><span>throw</span><span> </span><span>FirebaseControllerException</span><span>(</span><span>
          </span><span>'Failed to update Firestore with local data (${area.cards}): $e'</span><span>);</span><span>
    </span><span>}</span><span>
  </span><span>}</span><span>

  </span><span>/// Sends the local state of `boardState.areaOne` to Firestore.</span><span>
  </span><span>void</span><span> _updateFirestoreFromLocalAreaOne</span><span>()</span><span> </span><span>{</span><span>
    _updateFirestoreFromLocal</span><span>(</span><span>boardState</span><span>.</span><span>areaOne</span><span>,</span><span> _areaOneRef</span><span>);</span><span>
  </span><span>}</span><span>

  </span><span>/// Sends the local state of `boardState.areaTwo` to Firestore.</span><span>
  </span><span>void</span><span> _updateFirestoreFromLocalAreaTwo</span><span>()</span><span> </span><span>{</span><span>
    _updateFirestoreFromLocal</span><span>(</span><span>boardState</span><span>.</span><span>areaTwo</span><span>,</span><span> _areaTwoRef</span><span>);</span><span>
  </span><span>}</span><span>

  </span><span>/// Updates the local state of [area] with the data from Firestore.</span><span>
  </span><span>void</span><span> _updateLocalFromFirestore</span><span>(</span><span>
      </span><span>PlayingArea</span><span> area</span><span>,</span><span> </span><span>DocumentSnapshot</span><span>&lt;</span><span>List</span><span>&lt;</span><span>PlayingCard</span><span>&gt;&gt;</span><span> snapshot</span><span>)</span><span> </span><span>{</span><span>
    _log</span><span>.</span><span>fine</span><span>(</span><span>'Received new data from Firestore (${snapshot.data()})'</span><span>);</span><span>

    </span><span>final</span><span> cards </span><span>=</span><span> snapshot</span><span>.</span><span>data</span><span>()</span><span> </span><span>??</span><span> </span><span>[];</span><span>

    </span><span>if</span><span> </span><span>(</span><span>listEquals</span><span>(</span><span>cards</span><span>,</span><span> area</span><span>.</span><span>cards</span><span>))</span><span> </span><span>{</span><span>
      _log</span><span>.</span><span>fine</span><span>(</span><span>'No change'</span><span>);</span><span>
    </span><span>}</span><span> </span><span>else</span><span> </span><span>{</span><span>
      _log</span><span>.</span><span>fine</span><span>(</span><span>'Updating local data with Firestore data ($cards)'</span><span>);</span><span>
      area</span><span>.</span><span>replaceWith</span><span>(</span><span>cards</span><span>);</span><span>
    </span><span>}</span><span>
  </span><span>}</span><span>
</span><span>}</span><span>

</span><span>class</span><span> </span><span>FirebaseControllerException</span><span> </span><span>implements</span><span> </span><span>Exception</span><span> </span><span>{</span><span>
  </span><span>final</span><span> </span><span>String</span><span> message</span><span>;</span><span>

  </span><span>FirebaseControllerException</span><span>(</span><span>this</span><span>.</span><span>message</span><span>);</span><span>

  @override
  </span><span>String</span><span> toString</span><span>()</span><span> </span><span>=&gt;</span><span> </span><span>'FirebaseControllerException: $message'</span><span>;</span><span>
</span><span>}</span>
```

Notice the following features of this code:

-   The controller’s constructor takes a `BoardState`. This enables the controller to manipulate the local state of the game.
    
-   The controller subscribes to both local changes to update Firestore and to remote changes to update the local state and UI.
    
-   The fields `_areaOneRef` and `_areaTwoRef` are Firebase document references. They describe where the data for each area resides, and how to convert between the local Dart objects (`List<PlayingCard>`) and remote JSON objects (`Map<String, dynamic>`). The Firestore API lets us subscribe to these references with `.snapshots()`, and write to them with `.set()`.
    

## 5\. Use the Firestore controller

1.  Open the file responsible for starting the play session: `lib/play_session/play_session_screen.dart` in the case of the `card` template. You instantiate the Firestore controller from this file.
    
2.  Import Firebase and the controller:
    
    ```
    <span>import</span><span> </span><span>'package:cloud_firestore/cloud_firestore.dart'</span><span>;</span><span>
     </span><span>import</span><span> </span><span>'../multiplayer/firestore_controller.dart'</span><span>;</span>
    ```
    
3.  Add a nullable field to the `_PlaySessionScreenState` class to contain a controller instance:
    
    ```
    <span>FirestoreController</span><span>?</span><span> _firestoreController</span><span>;</span>
    ```
    
4.  In the `initState()` method of the same class, add code that tries to read the FirebaseFirestore instance and, if successful, constructs the controller. You added the `FirebaseFirestore` instance to `main.dart` in the _Initialize Firestore_ step.
    
    ```
    <span>final</span><span> firestore </span><span>=</span><span> context</span><span>.</span><span>read</span><span>&lt;</span><span>FirebaseFirestore</span><span>?&gt;();</span><span>
     </span><span>if</span><span> </span><span>(</span><span>firestore </span><span>==</span><span> </span><span>null</span><span>)</span><span> </span><span>{</span><span>
       _log</span><span>.</span><span>warning</span><span>(</span><span>"Firestore instance wasn't provided. "</span><span>
           </span><span>'Running without _firestoreController.'</span><span>);</span><span>
     </span><span>}</span><span> </span><span>else</span><span> </span><span>{</span><span>
       _firestoreController </span><span>=</span><span> </span><span>FirestoreController</span><span>(</span><span>
         instance</span><span>:</span><span> firestore</span><span>,</span><span>
         boardState</span><span>:</span><span> _boardState</span><span>,</span><span>
       </span><span>);</span><span>
     </span><span>}</span>
    ```
    
5.  Dispose of the controller using the `dispose()` method of the same class.
    
    ```
    <span>_firestoreController</span><span>?.</span><span>dispose</span><span>();</span>
    ```
    

## 6\. Test the game

1.  Run the game on two separate devices or in 2 different windows on the same device.
    
2.  Watch how adding a card to an area on one device makes it appear on the other one.
    
3.  Open the [Firebase web console](https://console.firebase.google.com/) and navigate to your project’s Firestore Database.
    
4.  Watch how it updates the data in real time. You can even edit the data in the console and see all running clients update.
    
    ![Screenshot of the Firebase Firestore data view](https://docs.flutter.dev/assets/images/docs/cookbook/multiplayer-firebase-data.png)
    

### Troubleshooting

The most common issues you might encounter when testing Firebase integration include the following:

-   **The game crashes when trying to reach Firebase.**
    -   Firebase integration hasn’t been properly set up. Revisit _Step 2_ and make sure to run `flutterfire configure` as part of that step.
-   **The game doesn’t communicate with Firebase on macOS.**
    -   By default, macOS apps don’t have internet access. Enable [internet entitlement](https://docs.flutter.dev/data-and-backend/networking#macos) first.

## 7\. Next steps

At this point, the game has near-instant and dependable synchronization of state across clients. It lacks actual game rules: what cards can be played when, and with what results. This depends on the game itself and is left to you to try.

![An illustration of two mobile phones and a two-way arrow between them](https://docs.flutter.dev/assets/images/docs/cookbook/multiplayer-two-mobiles.jpg)

At this point, the shared state of the match only includes the two playing areas and the cards within them. You can save other data into `_matchRef`, too, like who the players are and whose turn it is. If you’re unsure where to start, follow [a Firestore codelab or two](https://codelabs.developers.google.com/?product=flutter&text=firestore) to familiarize yourself with the API.

At first, a single match should suffice for testing your multiplayer game with colleagues and friends. As you approach the release date, think about authentication and match-making. Thankfully, Firebase provides a [built-in way to authenticate users](https://firebase.google.com/docs/auth/flutter/start) and the Firestore database structure can handle multiple matches. Instead of a single `match_1`, you can populate the matches collection with as many records as needed.

![Screenshot of the Firebase Firestore data view with additional matches](https://docs.flutter.dev/assets/images/docs/cookbook/multiplayer-firebase-match.png)

An online match can start in a “waiting” state, with only the first player present. Other players can see the “waiting” matches in some kind of lobby. Once enough players join a match, it becomes “active”. Once again, the exact implementation depends on the kind of online experience you want. The basics remain the same: a large collection of documents, each representing one active or potential match.